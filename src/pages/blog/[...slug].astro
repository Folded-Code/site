---
import { CollectionEntry, getCollection } from 'astro:content'
import Section from '../../components/Section.astro'
import Layout from '../../layouts/Layout.astro'
import { formatDate } from '../../utils/funcs'
import Card from '../../components/Card.astro'

export async function getStaticPaths() {
  const posts = await getCollection('blog')
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }))
}
type Props = CollectionEntry<'blog'>

const post = Astro.props
const { Content } = await post.render()
---

<Layout title={`${post.data.title} - Thomas Forbes`}>
  <Section class="space-y-4">
    <h1>{post.data.title}</h1>
    <p>
      Published <time>{formatDate(post.data.pubDate)}</time>{
        post.data.updatedDate && (
          <>
            last updated
            <time>
              {formatDate(post.data.updatedDate || post.data.pubDate)}
            </time>
          </>
        )
      }
    </p>
  </Section>
  <Section class="text-justify">
    <article class="w-full">
      <Card class="w-full space-y-3">
        <Content />
      </Card>
    </article>
  </Section>
</Layout>

<style>
  time {
    @apply text-slate-300;
  }
</style>

<style is:global>
  article {
    * {
      @apply px-2;
    }
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      @apply !px-0 text-slate-200;
    }
    h1,
    h2 {
      @apply pt-6 text-3xl font-bold md:text-4xl;
    }
    h3 {
      @apply pt-4 text-xl font-bold md:text-2xl;
    }
    h4 {
      @apply pt-2 text-base font-bold md:text-lg;
    }

    li,
    p {
      @apply font-mono text-slate-400;
    }

    a {
      @apply !px-0 text-slate-300;
    }

    pre {
      @apply rounded-xl border border-slate-200/10 px-4 py-3;
    }

    blockquote {
      @apply border-l border-slate-200/40 pl-2 italic;
    }

    table {
      @apply mx-2 border-collapse border border-slate-200/10;
    }

    th,
    td {
      @apply border border-slate-200/10 p-2 text-slate-300;
    }

    th {
      @apply bg-slate-300/20;
    }

    tr {
      @apply odd:bg-slate-200/5 even:bg-slate-200/10;
    }

    ul {
      @apply list-inside list-disc;
    }
  }
</style>
